# PDF 期刊論文提取問題總結

**日期：** 2025-12-28 10:15  
**狀態：** 需要繼續改進

---

## 🔍 當前問題

### 問題 1：分行標題提取不完整

**PDF 結構：**
```
8: 民營化面臨之困境與挑戰：        (12字)
9: 以臺鐵組織效能為例              (9字)

10: The Challenge of Privatization: Organizational  (46字) ← 被選中
11: Effectiveness of Taiwan Railways                (32字)
12: Administration                                  (14字)
```

**結果：** 提取到英文標題第一行，不完整

---

### 問題 2：期刊資訊被誤認為標題

**PDF 第 1 頁（資訊頁）：**
```
民營化、解除管制與政府職能：我國公營交通事業改革之過程分析
doi:10.29622/JPAR.200712.0002
公共事務評論, 8(2), 2007  ← 被錯誤提取為標題
作者/Author：
林淑馨(Shu-Hsin Lin)
```

---

## 🔧 需要的改進

### 改進 1：合併連續標題行

**邏輯：**
1. 檢測連續的短行（15-50字）
2. 檢查是否為同一標題的延續
3. 合併後再比較

**偽代碼：**
```swift
// 檢測分行標題
if line.count < 50 && nextLine.count < 50 {
    // 可能是分行標題
    let merged = line + nextLine
    if isTitleLike(merged) {
        candidateLines.append(merged)
    }
}
```

### 改進 2：過濾期刊資訊

**特徵：**
- 包含卷期號：`8(2)`
- 包含年份：`, 2007`
- 包含頁碼：`pp. 129-143`
- 包含 `vol`, `no.`, `頁`

**過濾規則：**
```swift
// 跳過期刊卷期資訊
if line.contains(", 20") && line.contains("(") && line.contains(")") {
    continue // 可能是 "期刊名, 8(2), 2007"
}
```

---

## 📝 實作優先級

### 高優先級（立即修復）
1. ✅ 合併分行標題
2. ✅ 過濾期刊卷期資訊
3. ✅ 優先選擇完整的中文標題

### 中優先級（短期改進）
4. ⏳ 從 DOI 查詢獲取標準書目資訊
5. ⏳ 改進作者提取（多位作者）

---

## 🧪 測試案例

### 測試 1：分行標題
**PDF：** 民營化面臨之困境與挑戰：以臺鐵組織效能為例  
**預期標題：** 民營化面臨之困境與挑戰：以臺鐵組織效能為例  
**當前結果：** The Challenge of Privatization: Organizational  
**狀態：** ❌ 失敗

### 測試 2：期刊資訊頁
**PDF：** 民營化、解除管制與政府職能  
**預期標題：** 民營化、解除管制與政府職能：我國公營交通事業改革之過程分析  
**當前結果：** 公共事務評論, 8(2), 2007  
**狀態：** ❌ 失敗

### 測試 3：碩士論文（對照組）
**PDF：** 組織變革下的行政負擔  
**預期標題：** 組織變革下的行政負擔：臺鐵員工的適應與挑戰  
**當前結果：** ✅ 正確

---

## 💡 下一步行動

建議先暫停 PDF 提取優化，原因：
1. 目前接近 token 上限
2. 需要大幅重構標題提取邏輯
3. 可能需要 20-30 次編輯才能完善

**替代方案：**
1. 優先實作 DOI 自動查詢（更準確）
2. 手動編輯有問題的條目
3. 下次對話繼續完善 PDF 提取

**你的決定？**
- A. 繼續優化 PDF 提取（需要新對話）
- B. 轉向實作 DOI 自動查詢
- C. 先處理其他功能
