# OVEREND 文章寫作編輯器 - 功能需求與實作狀態

**日期：** 2025-12-29  
**狀態：** 部分實作完成  
**優先級：** 🔥 持續開發中

---

## 🎯 核心目標

打造一個**整合引用管理**的文章寫作環境，讓研究生能夠：

1. 專注於寫作內容
2. 快速插入文獻引用
3. 自動生成參考文獻列表
4. 輕鬆匯出各種格式

**對標產品：**

- Microsoft Word + EndNote（傳統方案）
- Notion + Zotero（現代方案）
- Overleaf（LaTeX 方案）

**OVEREND 的優勢：**

- ✨ 原生 macOS 體驗
- ✨ 繁體中文優化
- ✨ 文獻與寫作無縫整合
- ✨ AI 輔助（未來）

---

## � 實作進度總覽

| 模組 | 狀態 | 完成度 |
|------|------|--------|
| 基礎 UI 架構 | ✅ 已完成 | 100% |
| 編輯器視圖 | ✅ 已完成 | 80% |
| 引用功能 | 🔄 進行中 | 40% |
| 匯出功能 | ⏳ 待開發 | 0% |

---

## ✅ 已完成功能

### 1. 三視圖導航系統（100%）

```
Views/Writer/
├── EditorListView.swift         ✅ 文稿列表（卡片網格）
├── DocumentCardView.swift       ✅ 文稿卡片元件
├── ProfessionalEditorView.swift ✅ 專業編輯器視圖
└── CitationInspector.swift      ✅ 引用檢視面板
```

### 2. 文稿卡片列表（EditorListView）

- [x] 卡片網格顯示
- [x] 新增文稿按鈕
- [x] 文稿數量統計
- [x] 最近編輯時間顯示
- [x] 雙擊進入編輯器

### 3. 專業編輯器視圖（ProfessionalEditorView）

- [x] Word 風格工具列
- [x] 字體選擇器
- [x] 字體大小調整
- [x] 格式按鈕（粗體、斜體、底線、刪除線）
- [x] 對齊按鈕（左、中、右、兩端）
- [x] 列表按鈕（項目符號、編號）
- [x] 編輯區域
- [x] 引用面板（右側）
- [x] 返回按鈕

### 4. 引用檢視器（CitationInspector）

- [x] 引用格式選擇器（APA/MLA/Chicago）
- [x] 已使用引用列表
- [x] 引用搜尋功能
- [x] 從文獻庫選取引用

---

## 🔄 進行中功能

### A. 編輯器核心功能

- [ ] TextEditor 實際編輯功能
- [ ] 格式工具列實際套用
- [ ] 內容自動儲存
- [ ] Undo/Redo 支援

### B. 引用插入功能

- [ ] Cmd+K 快捷鍵插入
- [ ] 搜尋文獻彈窗
- [ ] 多選文獻插入
- [ ] 即時引用格式預覽
- [ ] 引用位置標記

**插入方式範例：**

```
原文：根據研究[   ]指出，改革需要...
         ↓ Cmd+K 快捷鍵
         ↓ 彈出文獻選擇器
         ↓ 選擇 Chen (2023)
         ↓
結果：根據研究 (Chen, 2023) 指出，改革需要...
```

### C. 參考文獻列表

- [ ] 自動生成列表
- [ ] 按姓氏排序
- [ ] 未引用文獻標記
- [ ] 一鍵更新

---

## ⏳ 待開發功能

### D. 匯出功能

- [ ] Word (.docx)
- [ ] PDF
- [ ] Markdown (.md)
- [ ] LaTeX (.tex)
- [ ] 包含參考文獻

### E. 進階功能

- [ ] 評論功能
- [ ] 修訂追蹤
- [ ] 版本控制
- [ ] AI 輔助改寫

---

## � 檔案結構

```
OVEREND/Views/Writer/
├── EditorListView.swift         # 文稿列表（卡片網格）
│   └── 顯示所有文稿、新增按鈕
│
├── DocumentCardView.swift       # 文稿卡片元件
│   └── 單一文稿卡片、預覽、操作
│
├── ProfessionalEditorView.swift # 專業編輯器
│   ├── 格式工具列
│   ├── 編輯區
│   └── 引用面板
│
└── CitationInspector.swift      # 引用檢視器
    ├── 格式選擇
    ├── 已使用引用
    └── 文獻庫搜尋
```

---

## 🎨 UI 設計

### 目前實作的佈局

```
┌─────────────────────────────────────────────────────┐
│  ← 返回   論文標題                    [格式工具列]    │
├─────────────────────────────────────┬───────────────┤
│                                     │               │
│         編輯區                       │  引用面板      │
│                                     │               │
│  # 第一章 緒論                       │  格式：APA    │
│                                     │               │
│  根據研究指出...                     │  已使用引用：  │
│                                     │  - Chen (2023)│
│                                     │  - Lin (2007) │
│                                     │               │
│                                     │  [插入引用]   │
│                                     │               │
└─────────────────────────────────────┴───────────────┘
```

### 格式工具列

```
┌─────────────────────────────────────────────────────┐
│ [字體▼] [大小▼] | B I U S | ≡ ≡ ≡ ≡ | • 1. | [引用] │
└─────────────────────────────────────────────────────┘
  字體選擇  大小   粗斜底刪   對齊方式   列表  插入引用
```

---

## 🚀 開發路線圖

### Phase 1: MVP ✅ 部分完成

**目標：** 基本可用的寫作環境

已完成：

- [x] 編輯器 UI 架構
- [x] 格式工具列 UI
- [x] 引用面板 UI
- [x] 三視圖導航

待完成：

- [ ] TextEditor 實際編輯
- [ ] 引用插入功能
- [ ] 自動儲存

### Phase 2: 增強版

**目標：** 完善使用體驗

- [ ] 圖片插入
- [ ] 表格支援
- [ ] 多種匯出格式
- [ ] 字數統計

### Phase 3: 進階版

**目標：** 專業級功能

- [ ] Rich Text 編輯
- [ ] 版本控制
- [ ] AI 輔助
- [ ] 協作功能

---

## � 相關檔案

| 檔案 | 說明 |
|------|------|
| `Views/Writer/EditorListView.swift` | 文稿列表 |
| `Views/Writer/DocumentCardView.swift` | 文稿卡片 |
| `Views/Writer/ProfessionalEditorView.swift` | 專業編輯器 |
| `Views/Writer/CitationInspector.swift` | 引用檢視器 |
| `Models/Document.swift` | 文稿資料模型 |
| `Services/CitationService.swift` | 引用格式服務 |

---

## 💡 下一步行動

1. **實作 TextEditor 實際編輯功能**
   - 連接 Document 模型
   - 實作自動儲存

2. **實作引用插入快捷鍵（Cmd+K）**
   - 彈出文獻選擇器
   - 插入引用標記

3. **實作參考文獻自動生成**
   - 解析文件中的引用
   - 生成格式化列表

---

**最後更新：2025-12-29**
