# OVEREND AI 智慧功能總覽

## 功能摘要

OVEREND 整合了 **Apple Intelligence**，提供以下 AI 驅動的智慧功能：

1. **LaTeX 混合模式** - 自然語言生成數學公式
2. **智慧排版** - 自動調整為 APA 格式
3. **引用格式修正** - 自動修正為 APA 第 7 版
4. **目錄生成** - 自動產生階層式目錄
5. **段落間距調整** - 學術論文格式排版
6. **文字潤飾** - AI 改寫與優化

---

## 1. LaTeX 混合模式

### 特色
- 在 WYSIWYG 編輯器中插入 LaTeX 數學公式
- 使用自然語言描述公式，AI 自動轉換
- 即時渲染為圖片，雙擊可重新編輯

### 使用方式

#### 方法一：AI 智慧生成（推薦）
1. 點選「插入」→「插入 LaTeX 公式...」
2. 在「AI 智慧生成」欄位輸入描述：
   ```
   畢氏定理
   二次方程式的解
   高斯積分
   泰勒級數展開
   ```
3. 點擊「生成」，AI 自動轉換為 LaTeX
4. 預覽確認後插入

#### 方法二：手動輸入
1. 直接在編輯器輸入：`$E=mc^2$`
2. 按下 **⌘⇧L** 或右鍵選單「渲染 LaTeX 公式」
3. 公式自動渲染為圖片

### 範例

| 描述 | AI 生成的 LaTeX |
|------|----------------|
| 畢氏定理 | `a^2 + b^2 = c^2` |
| 二次方程式解 | `x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}` |
| 歐拉公式 | `e^{i\pi} + 1 = 0` |
| 高斯積分 | `\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}` |

### 系統需求
- macOS 需安裝 LaTeX（推薦 MacTeX）
- 下載：https://www.tug.org/mactex/

---

## 2. 智慧排版（APA 格式）

### 特色
- 自動調整為 APA 第 7 版學術論文格式
- 標題層級自動識別與調整
- 段落對齊、行距、縮排自動優化
- AI 分析文章結構並提出改進建議

### 使用方式
1. 打開浮動 AI 助手（右下角）
2. 點擊「智慧排版（APA 格式）」
3. AI 自動分析並套用格式
4. 查看改動說明與建議
5. 點擊「返回主選單」可回到功能列表

### 排版規則

#### 標題層級
- **H1（章標題）**：粗體、置中、18-20pt
- **H2（節標題）**：粗體、靠左、16-18pt
- **H3（小節標題）**：粗體、靠左、14-16pt
- **正文**：一般段落、12-14pt

#### 段落格式
- **對齊方式**：左右對齊（Justified）
- **行距**：1.5 倍（12pt）
- **段落間距**：12pt
- **首行縮排**：2 字元（28pt）
- **邊距**：上下左右各 1 英寸（72pt）

---

## 3. 引用格式修正

### 特色
- 自動將引用格式修正為 APA 第 7 版
- 識別並修正文內引用
- 自動調整參考文獻格式

### APA 第 7 版引用規則

#### 文內引用
```
單作者：(Smith, 2020)
雙作者：(Smith & Jones, 2020)
三位以上：(Smith et al., 2020)
直接引用：(Smith, 2020, p. 123)
多篇文獻：(Smith, 2019, 2020)
```

#### 參考文獻格式

**期刊文章**：
```
作者 (年份). 文章標題. 期刊名稱, 卷號(期號), 頁碼. DOI
```

**書籍**：
```
作者 (年份). 書名. 出版社.
```

**網路資源**：
```
作者 (年份, 月 日). 標題. 網站名稱. URL
```

### 使用方式
1. 打開浮動 AI 助手
2. 點擊「修正引用格式」
3. AI 自動掃描並修正全文引用

---

## 4. 目錄生成

### 特色
- 自動掃描文件中的標題
- 建立階層式目錄（章、節、小節）
- 自動編號（1、1.1、1.1.1）
- 在文件開頭插入

### 目錄格式範例

```
目錄

1. 緒論
   1.1. 研究背景
   1.2. 研究目的
   1.3. 研究範圍與限制

2. 文獻探討
   2.1. 理論基礎
   2.2. 相關研究
       2.2.1. 國內研究
       2.2.2. 國外研究

3. 研究方法
   3.1. 研究設計
   3.2. 研究對象
   3.3. 資料分析
```

### 使用方式
1. 確保文章已設定標題樣式（H1、H2、H3）
2. 打開浮動 AI 助手
3. 點擊「生成目錄」
4. 目錄自動插入文件開頭

---

## 5. 段落間距調整

### 特色
- 快速套用學術論文格式
- 自動調整行距、段落間距、縮排
- 支援三種預設樣式

### 樣式選項

#### 學術論文樣式（Academic）
- 左右對齊
- 1.5 倍行距（12pt）
- 段落間距 12pt
- 首行縮排 2 字元

#### 緊湊樣式（Compact）
- 靠左對齊
- 1.0 倍行距（6pt）
- 段落間距 8pt
- 無首行縮排

#### 鬆散樣式（Loose）
- 靠左對齊
- 2.0 倍行距（16pt）
- 段落間距 24pt
- 無首行縮排

### 使用方式
1. 打開浮動 AI 助手
2. 點擊「調整段落間距」
3. 自動套用學術論文格式

---

## 6. 文字潤飾

### 特色
- AI 改寫選取的文字
- 改善語氣、文法、用詞
- 保持原意並提升專業度

### 使用方式
1. 選取要潤飾的文字
2. 打開浮動 AI 助手
3. 點擊「潤飾選取的文字」
4. AI 提供改寫建議，可接受或拒絕

---

## 技術架構

### 核心服務

#### AILatexGenerator.swift
- **功能**：自然語言 → LaTeX 轉換
- **API**：Apple Intelligence Writing Tools
- **方法**：
  ```swift
  AILatexGenerator.generateFormula(from: "畢氏定理")
  // 輸出：a^2 + b^2 = c^2
  ```

#### AILayoutFormatter.swift
- **功能**：智慧排版與格式化
- **類型**：學術論文、報告、學位論文、期刊文章
- **方法**：
  ```swift
  AILayoutFormatter.format(text: attributedString, type: .academic)
  AILayoutFormatter.fixCitations(in: attributedString)
  AILayoutFormatter.generateTableOfContents(from: attributedString)
  AILayoutFormatter.adjustParagraphSpacing(in: attributedString, style: .academic)
  ```

#### LaTeXRenderer.swift
- **功能**：LaTeX → 圖片渲染
- **技術**：pdflatex 編譯
- **方法**：
  ```swift
  LaTeXRenderer.render(formula: "E=mc^2", fontSize: 16)
  ```

### UI 元件

#### LaTeXFormulaSheet.swift
- LaTeX 公式插入面板
- AI 智慧生成介面
- 快速模板與即時預覽

#### FloatingAIAssistant.swift
- 浮動 AI 助手面板
- 建議操作快捷按鈕
- AI 對話介面

#### LaTeXSupportedTextView.swift
- 支援 LaTeX 的文字視圖
- 即時渲染與雙擊編輯
- 公式快取機制

---

## 系統需求

### Apple Intelligence
- **作業系統**：macOS 15.1 或更新版本
- **處理器**：Apple M1 或更新晶片
- **設定**：系統設定中啟用 Apple Intelligence

### LaTeX 支援
- **軟體**：MacTeX 或 BasicTeX
- **下載**：https://www.tug.org/mactex/
- **驗證**：終端機執行 `which pdflatex`

---

## 使用提示

### 最佳實踐

1. **LaTeX 公式**：
   - 優先使用 AI 生成（降低學習門檻）
   - 複雜公式建議手動調整
   - 使用快速模板加速輸入

2. **智慧排版**：
   - 在草稿完成後再執行
   - 檢查 AI 建議並手動調整
   - 保存版本以便復原

3. **引用格式**：
   - 先使用 AI 修正，再手動檢查
   - 確認 DOI 與頁碼正確
   - 多位作者格式需特別注意

4. **目錄生成**：
   - 先設定好標題樣式
   - 確保標題層級正確
   - 目錄生成後可手動編輯

### 常見問題

**Q: AI 生成的 LaTeX 不正確？**
A: 可以手動修改公式後重新渲染，或使用快速模板。

**Q: 智慧排版改動太大？**
A: 可以使用「調整段落間距」單獨調整，或手動復原不需要的改動。

**Q: LaTeX 渲染失敗？**
A: 檢查是否安裝 MacTeX，執行 `which pdflatex` 確認。

**Q: Apple Intelligence 不可用？**
A: 確認 macOS 版本 ≥ 15.1，且處理器為 M1 或更新。

---

## 未來功能規劃

- [ ] 更多排版樣式（IEEE、ACM、Chicago 等）
- [ ] 批次處理多個文件
- [ ] 雲端同步排版設定
- [ ] 自訂排版規則
- [ ] LaTeX 公式庫（儲存常用公式）
- [ ] 圖表自動編號與交叉引用
- [ ] 多語言支援（英文、中文混排）
- [ ] 協作編輯與版本控制

---

## 相關文件

- [LaTeX 混合模式詳細指南](LATEX_HYBRID_MODE.md)
- [APA 第 7 版引用指南](APA_7th_Edition_Guide_for_OVEREND.md)

---

## 授權與致謝

- **Apple Intelligence**：Apple Inc.
- **LaTeX**：TeX Live（開源）
- **靈感來源**：Notion、Obsidian、Overleaf

---

**版本**：1.0
**最後更新**：2026-01-01
