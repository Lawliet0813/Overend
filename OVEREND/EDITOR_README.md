# OVEREND 類 Word 編輯器使用指南

## 概述

OVEREND 現在配備了全新的類 Word 風格富文本編輯器，提供完整的文字處理功能。

## 新增功能

### 1. 富文本格式化

#### 字體設定
- **字體選擇**：支援多種中英文字體
  - PingFang TC（繁體中文優化）
  - Songti TC（宋體）
  - Heiti TC（黑體）
  - Arial、Times New Roman 等英文字體
  
- **字體大小**：8pt - 72pt 可選
  - 常用：12pt、14pt、16pt
  - 標題：18pt、24pt、36pt

#### 文字樣式
- **粗體** (⌘B)：套用/取消粗體
- **斜體** (⌘I)：套用/取消斜體
- **底線** (⌘U)：套用/取消底線

#### 顏色
- **文字顏色**：完整色彩選擇器
- **螢光筆**：黃、綠、青、粉紅色可選

### 2. 段落格式化

#### 文字對齊
- 靠左對齊
- 置中對齊
- 靠右對齊
- 兩端對齊

#### 樣式套用
- 正文（14pt）
- 標題 1（24pt 粗體）
- 標題 2（20pt 粗體）
- 標題 3（18pt 粗體）

#### 列表
- 項目符號列表
- 自動縮排

### 3. 學術寫作功能

#### 引用管理
1. 點擊「插入引用」按鈕
2. 從文獻庫選擇書目
3. 自動插入 APA 格式引用：`[Smith, 2020]`
4. 引用顯示為藍色可點擊連結

#### 參考文獻生成
1. 點擊「參考文獻」按鈕
2. 自動列出所有已引用文獻
3. 依 APA 格式排版
4. 可一鍵複製全部

### 4. 文件管理

#### 自動儲存
- 編輯後 3 秒自動儲存
- 狀態列顯示儲存時間

#### 字數統計
- 即時顯示字數
- 中文字符單獨計數
- 英文單詞計數

#### 匯出功能
支援多種格式匯出：
- **PDF**：完整排版輸出
- **RTF**：保留格式
- 可選擇是否包含參考文獻列表

## 使用技巧

### 快速格式化
1. 選取文字
2. 使用鍵盤快捷鍵：
   - ⌘B：粗體
   - ⌘I：斜體
   - ⌘U：底線

### A4 紙張效果
編輯器模擬真實紙張效果：
- 標準 A4 尺寸（700×990 pt）
- 1 英寸邊距（72 pt）
- 白色紙張陰影效果

### 中英文混排
編輯器針對繁體中文優化：
- 預設使用 PingFang TC 字體
- 1.15 倍行高（類似 Word）
- 適當的段落間距

### 插入引用的最佳實踐
1. 先完成文章初稿
2. 在需要引用處點擊「插入引用」
3. 搜尋並選擇相關文獻
4. 完成後使用「參考文獻」生成列表

## 檔案結構

### 核心檔案
- `WordStyleEditorView.swift`：主編輯器視圖（類 Word 界面）
- `RichTextEditor.swift`：富文本編輯器核心（NSTextView 封裝）
- `CitationPicker.swift`：引用選擇器
- `WriterView.swift`：整合視圖

### 功能模組
- 格式化工具列
- 文字樣式按鈕
- 對齊控制
- 顏色選擇器
- 引用管理
- 匯出功能

## 技術細節

### NSTextView 功能
編輯器使用 AppKit 的 NSTextView，支援：
- 完整的富文本編輯
- 撤銷/重做
- 拼字檢查
- 文法檢查
- 智能替換
- 自動連結偵測

### 屬性字符串（AttributedString）
文件內容以 NSAttributedString 儲存：
- 保留所有格式資訊
- 支援 RTF 格式
- 可轉換為 PDF

### Core Data 整合
- 文件自動儲存到 Core Data
- RTF 格式二進制儲存
- 支援大型文件（外部儲存）

## 未來計劃

### 近期功能
- [ ] 插入圖片
- [ ] 插入表格
- [ ] 插入超連結
- [ ] 尋找與取代
- [ ] 頁首頁尾

### 長期計劃
- [ ] Word (.docx) 匯出
- [ ] LaTeX 匯出
- [ ] 協作編輯
- [ ] 版本控制
- [ ] 雲端同步

## 疑難排解

### 格式沒有套用
- 確認已選取文字
- 某些格式需要選取完整段落

### 自動儲存失敗
- 檢查 Core Data 連接
- 查看控制台錯誤訊息

### 字體無法顯示
- 確認系統已安裝該字體
- 使用系統字體作為備選

## 效能建議

### 大型文件
- 建議單一文件不超過 100 頁
- 大量圖片請使用外部連結
- 定期匯出備份

### 記憶體使用
- 編輯器會快取文件內容
- 關閉不使用的文件視窗
- 重啟 App 釋放記憶體

## 鍵盤快捷鍵

| 功能 | 快捷鍵 |
|------|--------|
| 粗體 | ⌘B |
| 斜體 | ⌘I |
| 底線 | ⌘U |
| 儲存 | ⌘S |
| 全選 | ⌘A |
| 複製 | ⌘C |
| 貼上 | ⌘V |
| 剪下 | ⌘X |
| 撤銷 | ⌘Z |
| 重做 | ⌘⇧Z |

## 授權與貢獻

本編輯器是 OVEREND 專案的一部分。
歡迎提交 Issue 和 Pull Request！
